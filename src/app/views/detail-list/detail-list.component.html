<div
  class="container py-4 d-flex justify-content-between align-content-center px-5"
>
  <div class="d-flex align-items-center gap-2">
    <div data-cy="todo-back-button">
      <a routerLink="/" class="text-black">
        <h4>
          <i class="bi bi-arrow-left-circle-fill pointer"></i>
        </h4>
      </a>
    </div>

    <div *ngIf="!editActive; else edit">
      <div class="d-flex align-items-center gap-3">
        <h4 data-cy="todo-title" class="fw-bold fs-4">{{ activity }}</h4>
        <i
          data-cy="todo-title-edit-button"
          (click)="handleEdit()"
          class="bi bi-pencil-fill text-secondary pointer"
        ></i>
      </div>
    </div>

    <ng-template #edit class="d-flex align-items-center gap-1">
      <input
        [(ngModel)]="activity"
        data-cy="todo-title"
        class="w-100 border-0 fs-4 ps-1 pe-5 fw-bold border-bottom focus:border-0 custom-input"
        type="text"
      />
      <i
        data-cy="todo-title-edit-button"
        (click)="handleActivityChange()"
        class="bi bi-pencil-fill text-secondary pointer"
      ></i>
    </ng-template>
  </div>

  <div class="d-flex gap-3">
    <div ngbDropdown class="d-inline-block bg-light rounded-3">
      <button
        data-cy="todo-sort-button"
        class="btn btn-outline-secondary rounded-5 text-center"
        id="dropdownBasic1"
        ngbDropdownToggle
      >
        <i class="bi bi-arrow-down-up"></i>
      </button>
      <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
        <div *ngFor="let item of sortItem">
          <button
            [attr.data-cy]="item.data"
            ngbDropdownItem
            class="d-flex gap-3 btn justify-content-between align-items-center"
          >
            <div class="d-flex gap-3">
              <i class="{{ item.icon }}"></i>
              <span>{{ item.title }}</span>
            </div>

            <i class="bi bi-check text-costum"></i>
          </button>
        </div>
      </div>
    </div>

    <button
      data-cy="todo-add-button"
      class="btn color-costum btn-secondary border-0 fw-semibold rounded-5 px-4 py-2 text-light :hover"
      (click)="openModalAddList(addlist)"
    >
      <i class="bi bi-plus text-light"></i>
      Tambah
    </button>
  </div>
</div>
<div *ngIf="todoList.length > 0; else todoEmpty">
  <div
  *ngFor="let item of todoList"
  class="container d-flex flex-column justify-content-center align-items-center mt-2"
>
  <div data-cy="todo-item" class="list-container">
    <div class="form-check d-flex align-items-center gap-4">
      <div>
        <input
          class="form-check-input custom-checkbox"
          type="checkbox"
          [checked]="item.is_active"
          (change)="handleCheck(item)"
          id="flexCheckDefault"
        />
        <i
          class="bi bi-circle-fill {{
            item.priority === 'very_high'
              ? 'text-danger'
              : item.priority === 'high'
              ? 'text-warning'
              : item.priority === 'medium'
              ? 'text-success'
              : item.priority === 'low'
              ? 'text-info'
              : 'costum-color'
          }}"
        ></i>
        <span
          class="ms-2 me-3 fw-bold text-capitalize {{
            item.is_active ? ' text-decoration-line-through text-secondary' : ''
          }}"
          >{{ item.title }}</span
        >
        <i
          (click)="openModalAddList(editlist)"
          class="bi bi-pencil-fill text-secondary pointer"
        ></i>
      </div>
    </div>

    <i
      (click)="openVerticallyCentered(alertDelete)"
      class="bi bi-trash3 text-secondary pointer"
    ></i>
  </div>
</div>

</div>


<ng-template #alertDelete>
  <app-alert-modal [message]="message" />
</ng-template>

<ng-template #addlist>
  <app-addlist-modal [title]="titleAddList" (emitList)="addNewList($event)" />
</ng-template>

<ng-template #editlist>
  <app-addlist-modal [title]="titleEditList" />
</ng-template>

<ng-template #todoEmpty>
  <div
  (click)="openModalAddList(addlist)"
    data-cy="todo-empty-state"
    class="container-md justify-content-center mt-5 d-flex align-items-center"
  >
    <img
      class="w-25 pointer"
      src="assets/todo-empty-state.png"
      alt="hero-pic"
    />
  </div>
</ng-template>
